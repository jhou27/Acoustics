function make_spect2 (signal, sRate, Wsize, maxfreq, contrast);% calculate and plot a spectrogram% Louis Goldstein% Dec 4, 2007%% input arguments:% 	signal		%	sRate		sampling rate in Hz%	Wsize		window size in ms%   maxfreq	    highest frequency to display%   contrast	B/W contrast (def. = 4); if nargin < 4, maxfreq = sRate/2; end;if nargin < 5, contrast = 4; end;if maxfreq > sRate/2, maxfreq = sRate/2; end;if sRate < 25000, Nfreqs = 256; else Nfreqs = 512; end;freqsPlot =  round (Nfreqs .* (maxfreq/(sRate/2)));% pre-emphasize, so analyze diff of signalsg = ComputeSgram(diff(signal), sRate, Nfreqs, freqsPlot, Wsize, 1);nFrames = size(sg,2);  % frames are 1 millisecondf = linspace(0,maxfreq,freqsPlot); set(axes, 'xlim', [1 nFrames], 'ylim', [0 maxfreq]);subplot (3,1,3), imagesc(1:nFrames, f, sg);set(gca, 'ydir', 'normal', 'box', 'on');colormap(flipud(gray(256).^contrast));xlabel ('Time in Millliseconds');ylabel ('Frequency in Hz');